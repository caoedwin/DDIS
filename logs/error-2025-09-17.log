[2025-09-17 15:03:56,831] [log.py:228] [log:log_response] [ERROR]- Internal Server Error: /CommonFiles/ppt_preview/36/
Traceback (most recent call last):
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\exception.py", line 34, in inner
    response = get_response(request)
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\base.py", line 126, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\base.py", line 124, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Python3129\mecheck\lib\site-packages\django\views\decorators\csrf.py", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File "C:\djangoproject\Reliability_Row_data\CommonFiles\views.py", line 764, in ppt_preview
    file_obj = files.objects.get(id=file_id)
UnboundLocalError: local variable 'files' referenced before assignment
[2025-09-17 15:11:05,269] [log.py:228] [log:log_response] [ERROR]- Internal Server Error: /CommonFiles/ppt_preview/36/
Traceback (most recent call last):
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\exception.py", line 34, in inner
    response = get_response(request)
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\base.py", line 126, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\base.py", line 124, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Python3129\mecheck\lib\site-packages\django\views\decorators\csrf.py", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File "C:\djangoproject\Reliability_Row_data\CommonFiles\views.py", line 766, in ppt_preview
    file_path = file_obj.attachment.path  # 假设attachment是FileField
AttributeError: 'files' object has no attribute 'attachment'
[2025-09-17 15:11:50,953] [log.py:228] [log:log_response] [ERROR]- Internal Server Error: /CommonFiles/ppt_preview/36/
Traceback (most recent call last):
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\exception.py", line 34, in inner
    response = get_response(request)
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\base.py", line 126, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File "C:\Python3129\mecheck\lib\site-packages\django\core\handlers\base.py", line 124, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Python3129\mecheck\lib\site-packages\django\views\decorators\csrf.py", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File "C:\djangoproject\Reliability_Row_data\CommonFiles\views.py", line 780, in ppt_preview
    result = subprocess.run(cmd, capture_output=True, text=True)
  File "C:\Python372\lib\subprocess.py", line 472, in run
    with Popen(*popenargs, **kwargs) as process:
  File "C:\Python372\lib\subprocess.py", line 775, in __init__
    restore_signals, start_new_session)
  File "C:\Python372\lib\subprocess.py", line 1119, in _execute_child
    args = list2cmdline(args)
  File "C:\Python372\lib\subprocess.py", line 558, in list2cmdline
    return ''.join(result)
TypeError: sequence item 40: expected str instance, bytes found
